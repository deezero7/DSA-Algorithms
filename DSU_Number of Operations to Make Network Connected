class Solution {

    vector<int> parent;
    vector<int> rank;

    int Find(int u){
        if(parent[u] == u) {return parent[u];}
        // path compress
        return parent[u] = Find(parent[u]);
    }

    void Union(int u, int v){
        int uParent = Find(u);
        int vParent = Find(v);
        if (uParent == vParent) return;

        if(rank[uParent] < rank[vParent]){
            parent[uParent] = vParent;
        }
        else if(rank[vParent] < rank[uParent]){
            parent[vParent] = uParent;
        }
        else{
            parent[uParent] = vParent;
            rank[vParent]++;
        }
    }
public:
    int makeConnected(int n, vector<vector<int>>& connections) {
        if(connections.size() < n-1){
            return -1;
        }

        parent.resize(n);
        rank.resize(n);
        for(int i=0;i<n;i++){
            parent[i] = i;
            rank[i] = 1;
        }

        for(auto& ele: connections){
            Union(ele[0],ele[1]);
        }

        set<int> sett;
        for(auto& ele: parent){
            sett.insert(Find(ele)); // ensures we insert only the root representatives
        }
        
        return sett.size()-1;
        
        

    }
};
